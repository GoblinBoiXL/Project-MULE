<rolltemplate class="sheet-rolltemplate-weapon">
  <div class="sheet-template-container">
    <div class="sheet-template-header">{{title}}</div>
    {{#attack}}<div class="sheet-template-row"><span>Attack Roll:</span> {{attack}}</div>{{/attack}}
    {{#ap}}<div class="sheet-template-row"><span>AP Cost:</span> {{ap}}</div>{{/ap}}
    {{#ammo}}<div class="sheet-template-row"><span>Ammo:</span> {{ammo}}</div>{{/ammo}}
    {{#range}}<div class="sheet-template-row"><span>Range:</span> {{range}}</div>{{/range}}
    {{#props}}<div class="sheet-template-row"><span>Properties:</span> {{props}}</div>{{/props}}
  </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-initiative">
  <div class="sheet-template-container">
    <div class="sheet-template-header">{{title}}</div>
    {{#result}}<div class="sheet-template-row">
      <span>Initiative:</span> {{result}}
    </div>{{/result}}
  </div>
</rolltemplate>

<div class="charsheet">
  <input type="hidden" class="sheet-tabstoggle" name="attr_sheetTab" value="combat" />

<div class="sheet-tab-buttons">
    <button type="action" name="act_combat" class="sheet-button0">Combat</button>
    <button type="action" name="act_attributes" class="sheet-button1">Attributes</button>
    <button type="action" name="act_inventory" class="sheet-button2">Inventory</button>
    <button type="action" name="act_perks" class="sheet-button3">Perks</button>
    </div> 

       <!-- Tab Panels --> 
  <div class="sheet-combat">
  <h2>Combat</h2>
  <!-- Health, Max Health & Summary Row -->
  <div class="health-display">
  <div class="row">
    <div class="field">
      <label>Health</label>
      <input type="number" name="attr_health" value="30">
    </div>
    <div class="field">
      <label>Max Health</label>
      <input type="number" name="attr_health_max" value="30">
    </div>
    <div class="field">
      <label>Heal</label>
      <button type="action" name="act_heal">âœš Heal</button>
    </div>
  </div>
  <div class="health-summary">
    Health: <span name="attr_health"></span>/<span name="attr_health_max"></span>
  </div>
</div>
  <!-- Armor Block -->
<div class="armor-block">
  <div class="row">
    <div class="field">
      <label>Armor</label>
      <input type="number" name="attr_armor" value="0">
    </div>
    <div class="field">
      <label>Armor Rating (0-5)</label>
      <input type="number" name="attr_armor_rating" value="5" min="0" max="5">
    </div>
    <div class="field">
      <label>Repair</label>
      <button type="action" name="act_repair_armor">ðŸ”§ Repair</button>
    </div>
  </div>
</div>
    <!-- PRIMARY WEAPON -->
<div class="weapon-block">
  <h3>Primary Weapon</h3>
  <div class="weapon-row">
    <div class="weapon-field">
      <label>Name</label>
      <input type="text" name="attr_primary_name">
    </div>
    <div class="weapon-field">
      <label>AP Cost</label>
      <input type="number" name="attr_primary_ap" value="3">
    </div>
    <div class="weapon-field">
      <label>Ammo</label>
      <input type="text" name="attr_primary_ammo" placeholder="12/16">
    </div>
    <div class="weapon-field">
      <label>Range</label>
      <input type="text" name="attr_primary_range" placeholder="30ft / 90ft">
    </div>
  </div>
  <div class="weapon-row">
    <div class="weapon-field">
      <label>Dice Count</label>
      <input type="number" name="attr_primary_dicecount" value="4">
    </div>
    <div class="weapon-field">
      <label>Die Type</label>
      <select name="attr_primary_dietype">
        <option value="4">d4</option>
        <option value="6" selected>d6</option>
        <option value="8">d8</option>
        <option value="10">d10</option>
        <option value="12">d12</option>
      </select>
    </div>
    <div class="weapon-field">
      <label>Dice Formula</label>
      <input type="text" name="attr_primary_dice" value="@{primary_dicecount}d@{primary_dietype}" disabled>
    </div>
  </div>
  <div class="weapon-row">
    <div class="weapon-field" style="flex: 2;">
      <label>Properties</label>
      <textarea name="attr_primary_properties" placeholder="e.g. Explosive, Silenced"></textarea>
    </div>
  </div>
  <button type="roll" value="&{template:weapon} {{title=@{primary_name}}} {{attack=[[@{primary_dicecount}d@{primary_dietype}!]]}} {{ap=@{primary_ap}}} {{ammo=@{primary_ammo}}} {{range=@{primary_range}}} {{props=@{primary_properties}}}">
    ðŸ”« Fire!
  </button>
</div>
<!-- SECONDARY WEAPON -->
<div class="weapon-block">
  <h3>Secondary Weapon</h3>
  <div class="weapon-row">
    <div class="weapon-field">
      <label>Name</label>
      <input type="text" name="attr_secondary_name">
    </div>
    <div class="weapon-field">
      <label>AP Cost</label>
      <input type="number" name="attr_secondary_ap" value="2">
    </div>
    <div class="weapon-field">
      <label>Ammo</label>
      <input type="text" name="attr_secondary_ammo" placeholder="6/12">
    </div>
    <div class="weapon-field">
      <label>Range</label>
      <input type="text" name="attr_secondary_range" placeholder="20ft / 60ft">
    </div>
  </div>
  <div class="weapon-row">
    <div class="weapon-field">
      <label>Dice Count</label>
      <input type="number" name="attr_secondary_dicecount" value="2">
    </div>
    <div class="weapon-field">
      <label>Die Type</label>
      <select name="attr_secondary_dietype">
        <option value="4">d4</option>
        <option value="6">d6</option>
        <option value="8" selected>d8</option>
        <option value="10">d10</option>
        <option value="12">d12</option>
      </select>
    </div>
    <div class="weapon-field">
      <label>Dice Formula</label>
      <input type="text" name="attr_secondary_dice" value="@{secondary_dicecount}d@{secondary_dietype}" disabled>
    </div>
  </div>
  <div class="weapon-row">
    <div class="weapon-field" style="flex: 2;">
      <label>Properties</label>
      <textarea name="attr_secondary_properties" placeholder="e.g. Piercing, Smoke rounds"></textarea>
    </div>
  </div>
  <button type="roll" value="&{template:weapon} {{title=@{secondary_name}}} {{attack=[[@{secondary_dicecount}d@{secondary_dietype}!]]}} {{ap=@{secondary_ap}}} {{ammo=@{secondary_ammo}}} {{range=@{secondary_range}}} {{props=@{secondary_properties}}}">
    ðŸ”« Fire!
  </button>
</div>
    <div class="section">
  <label>Initiative</label>
  <button type="roll" name="roll_initiative" value="&{template:initiative} {{title=@{character_name}}}  {{result=[[1d20 + @{perception} &{tracker}]]}}">ðŸŽ² Roll Initiative
  </button>
</div>  
  <div class="sheet-attributes">
  <h2>Attributes</h2>
  <div class="attributes-grid">
    <div class="attribute">
      <label>Strength</label>
      <input type="number" name="attr_strength" value="5" min="1" max="10">
    </div>
    <div class="attribute">
      <label>Perception</label>
      <input type="number" name="attr_perception" value="5" min="1" max="10">
    </div>
    <div class="attribute">
      <label>Endurance</label>
      <input type="number" name="attr_endurance" value="5" min="1" max="10">
    </div>
    <div class="attribute">
      <label>Charisma</label>
      <input type="number" name="attr_charisma" value="5" min="1" max="10">
    </div>
    <div class="attribute">
      <label>Intelligence</label>
      <input type="number" name="attr_intelligence" value="5" min="1" max="10">
    </div>
    <div class="attribute">
      <label>Agility</label>
      <input type="number" name="attr_agility" value="5" min="1" max="10">
    </div>
    <div class="attribute">
      <label>Luck</label>
      <input type="number" name="attr_luck" value="5" min="1" max="10">
    </div>
  </div>
</div>
  <div class="sheet-inventory">
    <h2>Inventory</h2>
    <span>Inventory tab content goes here...</span>
</div>
<div class="sheet-perks">
    <h2>Perks</h2>
    <span>Perks tab content goes here...</span>
</div>
    
<script type="text/worker">
  const buttonlist = ["act_combat", "act_attributes", "act_inventory", "act_perks"];
  buttonlist.forEach(button => {
    on(`clicked:${button}`, function() {
      setAttrs({
        sheetTab: button.replace("act_", "")
      });
    });
  });
</script>

